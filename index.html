<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browser Data Demonstration</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: url('Gigachad-1024x427-3344591563.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            min-height: 100vh;
            padding: 20px;
            font-size: 16px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
        }

        .warning-banner {
            background: rgba(255, 71, 87, 0.85);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .warning-banner h1 {
            font-size: 2em;
            margin-bottom: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .warning-banner p {
            font-size: 1.1em;
            opacity: 0.95;
        }

        .info-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
            animation: fadeIn 0.8s ease-out 0.3s both;
            grid-auto-rows: auto;
        }

        /* Tablet: 2 columns */
        @media (min-width: 768px) {
            .info-grid {
                grid-template-columns: repeat(2, 1fr);
                grid-auto-flow: dense;
            }
        }

        /* Desktop: 3 columns with masonry-like behavior */
        @media (min-width: 1200px) {
            .info-grid {
                grid-template-columns: repeat(3, 1fr);
                grid-auto-flow: dense;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .info-card {
            background: rgba(255, 255, 255, 0.85);
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            backdrop-filter: blur(10px);
        }

        .info-card h2 {
            color: #667eea;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #667eea;
            padding-bottom: 8px;
        }

        .info-item {
            display: grid;
            grid-template-columns: 200px 1fr;
            gap: 12px;
            padding: 10px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .info-item:last-child {
            border-bottom: none;
        }

        .info-label {
            font-weight: 600;
            color: #555;
            font-size: 0.95em;
        }

        .info-value {
            color: #333;
            word-break: break-word;
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 8px 10px;
            border-radius: 4px;
            font-size: 0.9em;
        }

        .loading {
            color: #999;
            font-style: italic;
        }

        .permission-needed {
            color: #ff4757;
            font-style: italic;
        }

        .request-permission-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.95em;
            transition: background 0.2s;
        }

        .request-permission-btn:hover {
            background: #5568d3;
        }

        @media (max-width: 767px) {
            .info-item {
                grid-template-columns: 1fr;
                gap: 8px;
            }

            .warning-banner h1 {
                font-size: 1.6em;
            }

            body {
                padding: 10px;
            }
        }

        .hidden {
            display: none;
        }

        /* Map container */
        .map-container {
            width: 100%;
            height: 400px;
            border-radius: 6px;
            overflow: hidden;
            margin-top: 15px;
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
            display: none;
        }

        .map-container.visible {
            display: block;
        }

        #location-map {
            width: 100%;
            height: 100%;
        }

        .location-info-box {
            background: #fff;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid #d32f2f;
            box-shadow: 0 1px 4px rgba(0,0,0,0.1);
            display: none;
            font-size: 1em;
        }

        .location-info-box.visible {
            display: block;
        }

        .location-info-box h3 {
            margin: 0 0 10px 0;
            color: #d32f2f;
            font-size: 1.1em;
        }

        .location-info-box p {
            margin: 6px 0;
            color: #333;
            font-size: 1em;
        }

        .location-info-box .coordinates {
            font-family: 'Courier New', monospace;
            background: #f5f5f5;
            padding: 4px;
            border-radius: 2px;
            margin-top: 4px;
            font-size: 0.8em;
        }

        .map-warning {
            background: #ffebee;
            padding: 10px;
            border-radius: 4px;
            margin-top: 10px;
            color: #c62828;
            font-size: 0.95em;
            text-align: center;
            font-weight: 600;
        }

        /* VPN Simulator Styles */
        .vpn-game {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 15px;
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            animation: fadeIn 0.8s ease-out 0.4s both;
            border: 2px solid #667eea;
        }

        .vpn-game h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.4em;
            text-align: center;
        }

        .vpn-toggle-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 25px;
        }

        .vpn-toggle {
            position: relative;
            width: 80px;
            height: 40px;
            background: #ff4757;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.4s ease;
            box-shadow: 0 2px 10px rgba(255, 71, 87, 0.4);
        }

        .vpn-toggle.active {
            background: linear-gradient(135deg, #00b894, #00cec9);
            box-shadow: 0 2px 10px rgba(0, 184, 148, 0.4);
        }

        .vpn-toggle::before {
            content: '';
            position: absolute;
            width: 32px;
            height: 32px;
            background: white;
            border-radius: 50%;
            top: 4px;
            left: 4px;
            transition: all 0.4s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .vpn-toggle.active::before {
            left: 44px;
        }

        .vpn-status {
            font-weight: 700;
            font-size: 1.1em;
            min-width: 100px;
        }

        .vpn-status.off {
            color: #ff4757;
        }

        .vpn-status.on {
            color: #00b894;
        }

        .vpn-server-select {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin-bottom: 25px;
            opacity: 0.3;
            pointer-events: none;
            transition: all 0.3s ease;
        }

        .vpn-server-select.active {
            opacity: 1;
            pointer-events: auto;
        }

        .server-btn {
            padding: 10px 18px;
            border: 2px solid #ddd;
            border-radius: 25px;
            background: white;
            cursor: pointer;
            font-size: 0.95em;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .server-btn:hover {
            border-color: #667eea;
            transform: translateY(-2px);
        }

        .server-btn.selected {
            border-color: #00b894;
            background: linear-gradient(135deg, #00b894, #00cec9);
            color: white;
            box-shadow: 0 3px 10px rgba(0, 184, 148, 0.3);
        }

        .server-flag {
            font-size: 1.3em;
        }

        .vpn-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 700px) {
            .vpn-comparison {
                grid-template-columns: 1fr;
            }
        }

        .vpn-panel {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s ease;
        }

        .vpn-panel.exposed {
            border: 2px solid #ff4757;
        }

        .vpn-panel.protected {
            border: 2px solid #00b894;
        }

        .vpn-panel h3 {
            font-size: 1.1em;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .vpn-panel.exposed h3 {
            color: #ff4757;
        }

        .vpn-panel.protected h3 {
            color: #00b894;
        }

        .vpn-data-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #e0e0e0;
            font-size: 0.95em;
        }

        .vpn-data-item:last-child {
            border-bottom: none;
        }

        .vpn-data-label {
            color: #666;
            font-weight: 500;
        }

        .vpn-data-value {
            font-family: 'Courier New', monospace;
            font-weight: 600;
        }

        .vpn-panel.exposed .vpn-data-value {
            color: #d32f2f;
        }

        .vpn-panel.protected .vpn-data-value {
            color: #00b894;
        }

        .shield-icon {
            font-size: 1.4em;
        }

        .vpn-explanation {
            background: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            padding: 15px;
            margin-top: 20px;
            text-align: center;
            font-size: 0.95em;
            color: #444;
            line-height: 1.5;
        }

        /* Glow animation for protected panel */
        @keyframes protectedGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(0, 184, 148, 0.3); }
            50% { box-shadow: 0 0 20px rgba(0, 184, 148, 0.5); }
        }

        .vpn-panel.protected.active-glow {
            animation: protectedGlow 2s ease-in-out infinite;
        }

        /* Shake animation for exposed panel */
        @keyframes exposedShake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-2px); }
            20%, 40%, 60%, 80% { transform: translateX(2px); }
        }

        .vpn-panel.exposed.shake {
            animation: exposedShake 0.5s ease-in-out;
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="warning-banner">
            <h1>DATA HARVESTED</h1>
            <p>This page has collected the following information from your browser</p>
            <p style="font-size: 0.9em; margin-top: 10px; opacity: 0.8;">(This is a demonstration - no data is being sent anywhere)</p>
        </div>

        <div class="info-card" style="animation: fadeIn 0.8s ease-out 0.2s both; margin-bottom: 15px; background: rgba(255, 243, 205, 0.85); border-left: 4px solid #ffc107;">
            <h2 style="color: #856404;">Security Risks</h2>
            <div style="color: #333; line-height: 1.5; font-size: 1em;">
                <p style="margin-bottom: 10px;">
                    <strong>QR Code Dangers:</strong> Phishing, malware, payment fraud, location tracking, data harvesting.
                    <strong>Data Collected:</strong> IP address (ISP/location), device fingerprint (screen/fonts/GPU), hardware specs, behavior patterns, network IPs (via WebRTC), privacy settings.
                    <strong>Note:</strong> This page could have included a fake login for a church, school, or any organization to capture your credentials - we didn't for simplicity and legality, but attackers do.
                </p>
                <p style="margin-bottom: 10px;">
                    <strong>Protection:</strong> Verify QR sources ‚Ä¢ Deny permissions ‚Ä¢ Use privacy browsers (Firefox/Brave) ‚Ä¢ Install uBlock Origin/Privacy Badger ‚Ä¢ Enable VPN ‚Ä¢ Disable 3rd-party cookies ‚Ä¢ Never enter real credentials on unfamiliar sites
                </p>
            </div>
        </div>

        <div class="info-grid">
            <div class="info-card">
                <h2>Network, Location & Time</h2>
                <div id="network-info"></div>
                <div id="location-info"></div>

                <!-- Interactive Map -->
                <div id="map-container" class="map-container">
                    <div id="location-map"></div>
                </div>

                <!-- Location Details Box -->
                <div id="location-details" class="location-info-box">
                    <h3>Your Exact Location Has Been Captured</h3>
                    <p><strong>Address:</strong> <span id="map-address" style="color: #d32f2f; font-weight: 600;">Loading...</span></p>
                    <p><strong>Latitude:</strong> <span id="map-lat">-</span></p>
                    <p><strong>Longitude:</strong> <span id="map-lon">-</span></p>
                    <p><strong>Accuracy:</strong> <span id="map-accuracy">-</span></p>
                    <div class="map-warning">
                        A malicious website could use this to track your movements, find your home address, or stalk you!
                    </div>
                </div>
            </div>

            <div class="info-card">
                <h2>Device, Browser & Hardware</h2>
                <div id="device-info"></div>
                <div id="hardware-info"></div>
            </div>

            <div class="info-card">
                <h2>Privacy, Settings & Fingerprinting</h2>
                <div id="privacy-info"></div>
                <div id="fingerprint-info"></div>
            </div>
        </div>

        <!-- Games Section -->
        <h2 style="color: white; text-align: center; margin: 30px 0 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5); font-size: 1.8em;">Interactive Privacy Demos</h2>

        <!-- VPN Simulator Game -->
        <div class="vpn-game">
            <h2>VPN Simulator: See the Difference</h2>

            <div class="vpn-toggle-container">
                <span class="vpn-status off" id="vpn-status">VPN OFF</span>
                <div class="vpn-toggle" id="vpn-toggle" onclick="toggleVPN()"></div>
                <span style="color: #666; font-size: 0.9em;">Click to toggle</span>
            </div>

            <div class="vpn-server-select" id="server-select">
                <button class="server-btn selected" data-server="germany" onclick="selectServer(this)">
                    <span class="server-flag">üá©üá™</span> Germany
                </button>
                <button class="server-btn" data-server="japan" onclick="selectServer(this)">
                    <span class="server-flag">üáØüáµ</span> Japan
                </button>
                <button class="server-btn" data-server="brazil" onclick="selectServer(this)">
                    <span class="server-flag">üáßüá∑</span> Brazil
                </button>
                <button class="server-btn" data-server="australia" onclick="selectServer(this)">
                    <span class="server-flag">üá¶üá∫</span> Australia
                </button>
            </div>

            <div class="vpn-comparison">
                <div class="vpn-panel exposed" id="exposed-panel">
                    <h3><span class="shield-icon">üö®</span> Without VPN (Exposed)</h3>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Your IP:</span>
                        <span class="vpn-data-value" id="real-ip">Loading...</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Location:</span>
                        <span class="vpn-data-value" id="real-location">Loading...</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">ISP:</span>
                        <span class="vpn-data-value" id="real-isp">Loading...</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Time Zone:</span>
                        <span class="vpn-data-value" id="real-timezone">Loading...</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Visible to:</span>
                        <span class="vpn-data-value">Everyone</span>
                    </div>
                </div>

                <div class="vpn-panel protected" id="protected-panel">
                    <h3><span class="shield-icon">üõ°Ô∏è</span> With VPN (Protected)</h3>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Masked IP:</span>
                        <span class="vpn-data-value" id="vpn-ip">---</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Location:</span>
                        <span class="vpn-data-value" id="vpn-location">---</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">ISP:</span>
                        <span class="vpn-data-value" id="vpn-isp">---</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Time Zone:</span>
                        <span class="vpn-data-value" id="vpn-timezone">---</span>
                    </div>
                    <div class="vpn-data-item">
                        <span class="vpn-data-label">Visible to:</span>
                        <span class="vpn-data-value" id="vpn-visible">---</span>
                    </div>
                </div>
            </div>

            <div class="vpn-explanation" id="vpn-explanation">
                Toggle the VPN switch above to see how your data appears to websites with and without protection.
            </div>
        </div>

    </div>

    <script>
        let map = null;
        let marker = null;

        // Global storage for real user data (used by VPN simulator)
        let realUserData = {
            ip: 'Loading...',
            location: 'Loading...',
            isp: 'Loading...',
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone
        };

        // Fallback: if data isn't loaded after 5 seconds, show error
        setTimeout(() => {
            if (realUserData.ip === 'Loading...') {
                realUserData.ip = 'Unable to fetch';
                const el = document.getElementById('real-ip');
                if (el) el.textContent = 'Unable to fetch';
            }
            if (realUserData.location === 'Loading...') {
                realUserData.location = 'Unknown';
                const el = document.getElementById('real-location');
                if (el) el.textContent = 'Unknown';
            }
            if (realUserData.isp === 'Loading...') {
                realUserData.isp = 'Unknown';
                const el = document.getElementById('real-isp');
                if (el) el.textContent = 'Unknown';
            }
        }, 5000);

        function displayLocationOnMap(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            const accuracy = position.coords.accuracy;

            // Show map container
            document.getElementById('map-container').classList.add('visible');
            document.getElementById('location-details').classList.add('visible');

            // Initialize map if not already done
            if (!map) {
                map = L.map('location-map').setView([lat, lon], 15);

                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
                    maxZoom: 19
                }).addTo(map);

                // Add a red pulsing marker
                const pulsingIcon = L.divIcon({
                    className: 'pulsing-marker',
                    html: '<div style="background: #d32f2f; width: 20px; height: 20px; border-radius: 50%; border: 3px solid white; box-shadow: 0 0 0 rgba(211, 47, 47, 0.4); animation: pulse-marker 2s infinite;"></div>',
                    iconSize: [20, 20]
                });

                marker = L.marker([lat, lon], { icon: pulsingIcon }).addTo(map);
                marker.bindPopup(`<strong>YOU ARE HERE</strong><br>Lat: ${lat.toFixed(6)}<br>Lon: ${lon.toFixed(6)}`).openPopup();

                // Add accuracy circle
                L.circle([lat, lon], {
                    color: '#d32f2f',
                    fillColor: '#f03',
                    fillOpacity: 0.2,
                    radius: accuracy
                }).addTo(map);

                // Add CSS for pulsing animation
                if (!document.getElementById('pulse-animation')) {
                    const style = document.createElement('style');
                    style.id = 'pulse-animation';
                    style.innerHTML = `
                        @keyframes pulse-marker {
                            0% {
                                box-shadow: 0 0 0 0 rgba(211, 47, 47, 0.7);
                            }
                            70% {
                                box-shadow: 0 0 0 20px rgba(211, 47, 47, 0);
                            }
                            100% {
                                box-shadow: 0 0 0 0 rgba(211, 47, 47, 0);
                            }
                        }
                    `;
                    document.head.appendChild(style);
                }
            } else {
                // Update existing marker
                marker.setLatLng([lat, lon]);
                map.setView([lat, lon], 15);
            }

            // Update location details
            document.getElementById('map-lat').textContent = lat.toFixed(6);
            document.getElementById('map-lon').textContent = lon.toFixed(6);
            document.getElementById('map-accuracy').textContent = `¬±${accuracy.toFixed(0)} meters`;

            // Reverse geocode to get address
            fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lon}&zoom=18&addressdetails=1`)
                .then(response => response.json())
                .then(data => {
                    if (data.display_name) {
                        document.getElementById('map-address').innerHTML = `<strong style="color: #d32f2f;">${data.display_name}</strong>`;
                    } else {
                        document.getElementById('map-address').textContent = 'Address lookup failed';
                    }
                })
                .catch(error => {
                    document.getElementById('map-address').textContent = 'Unable to determine address';
                });

            // Add to info section
            addInfo('location-info', 'Precise Location (from consent)',
                `Lat: ${lat.toFixed(6)}, Lon: ${lon.toFixed(6)}<br>` +
                `Accuracy: ${accuracy}m<br>` +
                `<strong style="color: #d32f2f;">Your exact location is shown on the map below!</strong>`
            );
        }

        // Helper function to create info items
        function addInfo(containerId, label, value) {
            const container = document.getElementById(containerId);
            if (!container) return;

            // Skip if value is unavailable/unknown
            const skipValues = ['Not available', 'Unknown', 'Not set', 'Unable to fetch', 'Unable to determine', null, undefined, ''];
            if (skipValues.includes(value) || value === 0 || value === '0') return;

            const item = document.createElement('div');
            item.className = 'info-item';
            item.innerHTML = `
                <div class="info-label">${label}</div>
                <div class="info-value">${value}</div>
            `;
            container.appendChild(item);
        }

        // Device & Browser Information
        addInfo('device-info', 'User Agent', navigator.userAgent);
        addInfo('device-info', 'Platform', navigator.platform);
        addInfo('device-info', 'Vendor', navigator.vendor);
        addInfo('device-info', 'Language', navigator.language);
        addInfo('device-info', 'Languages', navigator.languages.join(', '));
        addInfo('device-info', 'Online Status', navigator.onLine ? 'Online' : 'Offline');
        addInfo('device-info', 'Cookie Enabled', navigator.cookieEnabled ? 'Yes' : 'No');
        addInfo('device-info', 'PDF Viewer Enabled', navigator.pdfViewerEnabled ? 'Yes' : 'No');

        // Location & Network
        addInfo('location-info', 'Time Zone', Intl.DateTimeFormat().resolvedOptions().timeZone);
        addInfo('location-info', 'Time Zone Offset', new Date().getTimezoneOffset() + ' minutes');
        addInfo('location-info', 'Local Time', new Date().toString());
        addInfo('location-info', 'Referrer', document.referrer || 'Direct visit');

        // Connection information
        if (navigator.connection || navigator.mozConnection || navigator.webkitConnection) {
            const conn = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
            addInfo('location-info', 'Connection Type', conn.effectiveType);
            if (conn.downlink) addInfo('location-info', 'Downlink Speed', conn.downlink + ' Mbps');
            if (conn.rtt) addInfo('location-info', 'RTT', conn.rtt + ' ms');
            if (conn.saveData !== undefined) addInfo('location-info', 'Save Data Mode', conn.saveData ? 'Enabled' : 'Disabled');
        }

        // Geolocation (requires permission)
        const geoContainer = document.getElementById('location-info');
        const geoItem = document.createElement('div');
        geoItem.className = 'info-item';
        geoItem.innerHTML = `
            <div class="info-label">Geolocation</div>
            <div class="info-value" id="geo-value">
                <button class="request-permission-btn" onclick="requestGeolocation()">Request Location</button>
            </div>
        `;
        geoContainer.appendChild(geoItem);

        // Display & Hardware
        addInfo('hardware-info', 'Screen Resolution', `${screen.width} √ó ${screen.height}`);
        addInfo('hardware-info', 'Available Screen', `${screen.availWidth} √ó ${screen.availHeight}`);
        addInfo('hardware-info', 'Color Depth', screen.colorDepth + ' bits');
        addInfo('hardware-info', 'Pixel Ratio', window.devicePixelRatio);
        addInfo('hardware-info', 'Viewport Size', `${window.innerWidth} √ó ${window.innerHeight}`);
        addInfo('hardware-info', 'CPU Cores', navigator.hardwareConcurrency);
        if (navigator.deviceMemory) addInfo('hardware-info', 'Device Memory', navigator.deviceMemory + ' GB');
        addInfo('hardware-info', 'Max Touch Points', navigator.maxTouchPoints || 0);

        // Privacy & Settings
        addInfo('privacy-info', 'Do Not Track', navigator.doNotTrack || 'Not set');
        addInfo('privacy-info', 'Java Enabled', navigator.javaEnabled ? navigator.javaEnabled() : false);
        addInfo('privacy-info', 'Plugins Count', navigator.plugins ? navigator.plugins.length : 0);

        // List all plugins
        if (navigator.plugins && navigator.plugins.length > 0) {
            const pluginNames = Array.from(navigator.plugins).map(p => p.name).join(', ');
            addInfo('privacy-info', 'Plugins', pluginNames);
        }

        // Session/Local Storage
        try {
            localStorage.setItem('test', 'test');
            localStorage.removeItem('test');
            addInfo('privacy-info', 'Local Storage', 'Enabled');
        } catch (e) {
            addInfo('privacy-info', 'Local Storage', 'Disabled');
        }

        try {
            sessionStorage.setItem('test', 'test');
            sessionStorage.removeItem('test');
            addInfo('privacy-info', 'Session Storage', 'Enabled');
        } catch (e) {
            addInfo('privacy-info', 'Session Storage', 'Disabled');
        }

        // IndexedDB
        if (window.indexedDB) addInfo('privacy-info', 'IndexedDB', 'Available');

        // Advanced Fingerprinting
        // Canvas Fingerprinting
        try {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillText('Browser fingerprint', 2, 2);
            const canvasData = canvas.toDataURL();
            const canvasHash = canvasData.slice(-50);
            addInfo('fingerprint-info', 'Canvas Fingerprint', canvasHash);
        } catch (e) {
            addInfo('fingerprint-info', 'Canvas Fingerprint', 'Error: ' + e.message);
        }

        // WebGL Information
        try {
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            if (gl) {
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if (debugInfo) {
                    addInfo('fingerprint-info', 'WebGL Vendor', gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL));
                    addInfo('fingerprint-info', 'WebGL Renderer', gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL));
                }
                addInfo('fingerprint-info', 'WebGL Version', gl.getParameter(gl.VERSION));
            }
        } catch (e) {
            // WebGL not available - skip
        }

        // Audio Context Fingerprinting
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const analyser = audioContext.createAnalyser();
            const gainNode = audioContext.createGain();
            const scriptProcessor = audioContext.createScriptProcessor(4096, 1, 1);

            gainNode.gain.value = 0;
            oscillator.connect(analyser);
            analyser.connect(scriptProcessor);
            scriptProcessor.connect(gainNode);
            gainNode.connect(audioContext.destination);
            oscillator.start(0);

            addInfo('fingerprint-info', 'Audio Context', 'Sample Rate: ' + audioContext.sampleRate + ' Hz');

            oscillator.stop();
            audioContext.close();
        } catch (e) {
            // Audio context not available - skip
        }

        // Fonts detection (simplified)
        addInfo('fingerprint-info', 'Font Rendering', 'Unique per system/browser');

        // Battery API
        if (navigator.getBattery) {
            navigator.getBattery().then(battery => {
                addInfo('fingerprint-info', 'Battery Level', Math.round(battery.level * 100) + '%');
                addInfo('fingerprint-info', 'Battery Charging', battery.charging ? 'Yes' : 'No');
            });
        }

        // Media Devices
        if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
            navigator.mediaDevices.enumerateDevices().then(devices => {
                const audioInputs = devices.filter(d => d.kind === 'audioinput').length;
                const audioOutputs = devices.filter(d => d.kind === 'audiooutput').length;
                const videoInputs = devices.filter(d => d.kind === 'videoinput').length;
                addInfo('fingerprint-info', 'Media Devices', `${audioInputs} mic(s), ${videoInputs} camera(s), ${audioOutputs} speaker(s)`);
            });
        }

        // Function to request geolocation
        window.requestGeolocation = function() {
            const geoValue = document.getElementById('geo-value');
            geoValue.innerHTML = '<span class="loading">Requesting permission...</span>';

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    position => {
                        geoValue.innerHTML = `<strong style="color: #d32f2f;">Location Granted</strong><br>See map below`;
                        displayLocationOnMap(position);
                    },
                    error => {
                        geoValue.innerHTML = '<span class="permission-needed">Permission denied or unavailable</span>';
                    },
                    { enableHighAccuracy: true }
                );
            } else {
                geoValue.innerHTML = '<span class="permission-needed">Geolocation not supported</span>';
            }
        };

        // Detect installed apps via protocol handlers (limited)
        addInfo('fingerprint-info', 'Protocol Handlers', 'Can detect some installed apps');

        // Performance timing
        if (window.performance && window.performance.timing) {
            const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
            addInfo('fingerprint-info', 'Page Load Time', loadTime + ' ms');
        }

        // ===== NETWORK & IP INFORMATION =====

        // WebRTC IP Leak Detection
        function detectWebRTCIPs() {
            const ips = [];
            const RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection;

            if (!RTCPeerConnection) {
                addInfo('network-info', 'WebRTC IPs', 'Not supported');
                return;
            }

            const pc = new RTCPeerConnection({
                iceServers: [{urls: 'stun:stun.l.google.com:19302'}]
            });

            pc.createDataChannel('');
            pc.createOffer().then(offer => pc.setLocalDescription(offer));

            pc.onicecandidate = (ice) => {
                if (!ice || !ice.candidate || !ice.candidate.candidate) return;

                const candidate = ice.candidate.candidate;
                const ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/;
                const ipMatch = ipRegex.exec(candidate);

                if (ipMatch && !ips.includes(ipMatch[1])) {
                    ips.push(ipMatch[1]);
                    document.getElementById('webrtc-ips').innerHTML = ips.join('<br>');
                }
            };

            setTimeout(() => {
                pc.close();
                if (ips.length === 0) {
                    document.getElementById('webrtc-ips').innerHTML = '<span class="loading">No IPs detected (may be blocked)</span>';
                }
            }, 3000);
        }

        const networkItem = document.createElement('div');
        networkItem.className = 'info-item';
        networkItem.innerHTML = `
            <div class="info-label">WebRTC Local IPs</div>
            <div class="info-value" id="webrtc-ips"><span class="loading">Detecting...</span></div>
        `;
        document.getElementById('network-info').appendChild(networkItem);
        detectWebRTCIPs();

        // Fetch public IP using external service
        fetch('https://api.ipify.org?format=json')
            .then(response => response.json())
            .then(data => {
                addInfo('network-info', 'Public IPv4', data.ip);

                // Also update VPN simulator IP if not already set
                if (realUserData.ip === 'Loading...') {
                    realUserData.ip = data.ip;
                    const realIpEl = document.getElementById('real-ip');
                    if (realIpEl) realIpEl.textContent = data.ip;
                }
            })
            .catch(() => {
                // Unable to fetch - skip
            });

        // Get IP info with geolocation
        fetch('https://ipapi.co/json/')
            .then(response => response.json())
            .then(data => {
                addInfo('network-info', 'ISP', data.org);
                addInfo('network-info', 'City (from IP)', data.city);
                addInfo('network-info', 'Region', data.region);
                addInfo('network-info', 'Country', data.country_name);
                addInfo('network-info', 'Postal Code', data.postal);
                addInfo('network-info', 'ASN', data.asn);

                // Also update VPN simulator with real data
                realUserData.ip = data.ip || 'Unknown';
                realUserData.location = (data.city && data.country_name)
                    ? `${data.city}, ${data.country_name}`
                    : 'Unknown';
                realUserData.isp = data.org || 'Unknown ISP';

                const realIpEl = document.getElementById('real-ip');
                const realLocEl = document.getElementById('real-location');
                const realIspEl = document.getElementById('real-isp');

                if (realIpEl) realIpEl.textContent = realUserData.ip;
                if (realLocEl) realLocEl.textContent = realUserData.location;
                if (realIspEl) realIspEl.textContent = realUserData.isp;
            })
            .catch(() => {
                // Fallback: use ipify for just the IP
                fetch('https://api.ipify.org?format=json')
                    .then(r => r.json())
                    .then(d => {
                        realUserData.ip = d.ip || 'Unable to fetch';
                        realUserData.location = 'Unknown';
                        realUserData.isp = 'Unknown';

                        const realIpEl = document.getElementById('real-ip');
                        const realLocEl = document.getElementById('real-location');
                        const realIspEl = document.getElementById('real-isp');

                        if (realIpEl) realIpEl.textContent = realUserData.ip;
                        if (realLocEl) realLocEl.textContent = realUserData.location;
                        if (realIspEl) realIspEl.textContent = realUserData.isp;
                    })
                    .catch(() => {
                        realUserData.ip = 'Unable to fetch';
                        realUserData.location = 'Unable to fetch';
                        realUserData.isp = 'Unable to fetch';

                        const realIpEl = document.getElementById('real-ip');
                        const realLocEl = document.getElementById('real-location');
                        const realIspEl = document.getElementById('real-isp');

                        if (realIpEl) realIpEl.textContent = realUserData.ip;
                        if (realLocEl) realLocEl.textContent = realUserData.location;
                        if (realIspEl) realIspEl.textContent = realUserData.isp;
                    });
            });

        // ===== ADDITIONAL ADVANCED TRACKING =====

        // Mouse tracking snippet
        let mouseMovements = 0;
        document.addEventListener('mousemove', () => {
            mouseMovements++;
        });

        setTimeout(() => {
            addInfo('fingerprint-info', 'Mouse Activity (5s)', mouseMovements + ' movements');
        }, 5000);

        // Keyboard detection
        let keyPresses = 0;
        document.addEventListener('keydown', () => {
            keyPresses++;
        });

        setTimeout(() => {
            addInfo('fingerprint-info', 'Keyboard Activity (5s)', keyPresses + ' key presses');
        }, 5000);

        // Scroll behavior
        let scrollEvents = 0;
        window.addEventListener('scroll', () => {
            scrollEvents++;
        });

        // Detect ad blockers
        function detectAdBlocker() {
            const adTest = document.createElement('div');
            adTest.innerHTML = '&nbsp;';
            adTest.className = 'adsbox ad-banner ad-unit';
            adTest.style.width = '1px';
            adTest.style.height = '1px';
            document.body.appendChild(adTest);

            setTimeout(() => {
                const isBlocked = adTest.offsetHeight === 0;
                addInfo('fingerprint-info', 'Ad Blocker', isBlocked ? 'Likely detected' : 'Not detected');
                document.body.removeChild(adTest);
            }, 100);
        }
        detectAdBlocker();

        // Browser automation detection
        const automationSignals = [];
        if (navigator.webdriver) automationSignals.push('webdriver flag');
        if (window.callPhantom || window._phantom) automationSignals.push('PhantomJS');
        if (window.__nightmare) automationSignals.push('Nightmare');
        if (window.Buffer) automationSignals.push('Node.js Buffer');
        if (window.emit) automationSignals.push('CouchDB');
        if (window.spawn) automationSignals.push('Rhino');

        addInfo('fingerprint-info', 'Automation Detection', automationSignals.length > 0 ? 'Detected: ' + automationSignals.join(', ') : 'Not detected');

        // Chrome-specific features
        if (window.chrome) {
            addInfo('fingerprint-info', 'Chrome Object', 'Detected');
            if (window.chrome.runtime) {
                addInfo('fingerprint-info', 'Chrome Extensions', 'Runtime detected (extensions likely installed)');
            }
        }

        // Detect incognito/private mode (heuristic)
        async function detectIncognito() {
            // Test for various browser-specific private mode indicators
            if ('storage' in navigator && 'estimate' in navigator.storage) {
                const {usage, quota} = await navigator.storage.estimate();
                // In incognito, quota is often much smaller
                if (quota < 120000000) {
                    addInfo('privacy-info', 'Private Mode', 'Likely (low quota)');
                    return;
                }
            }

            // Test IndexedDB behavior
            try {
                const db = indexedDB.open('test');
                db.onerror = () => {
                    addInfo('privacy-info', 'Private Mode', 'Possibly (IndexedDB blocked)');
                };
            } catch (e) {
                addInfo('privacy-info', 'Private Mode', 'Possibly (IndexedDB error)');
                return;
            }

            addInfo('privacy-info', 'Private Mode', 'Unlikely (normal mode)');
        }
        detectIncognito();

        // Performance memory info (Chrome)
        if (performance.memory) {
            const usedMB = (performance.memory.usedJSHeapSize / 1048576).toFixed(2);
            const totalMB = (performance.memory.totalJSHeapSize / 1048576).toFixed(2);
            const limitMB = (performance.memory.jsHeapSizeLimit / 1048576).toFixed(2);
            addInfo('fingerprint-info', 'JS Heap Memory', `${usedMB} MB used / ${totalMB} MB total (limit: ${limitMB} MB)`);
        }

        // ===== VPN SIMULATOR GAME =====

        let vpnEnabled = false;
        let selectedServer = 'germany';

        // Populate real timezone immediately
        document.getElementById('real-timezone').textContent = realUserData.timezone;

        // Fake VPN server data
        const vpnServers = {
            germany: {
                ip: '185.193.126.' + Math.floor(Math.random() * 255),
                location: 'Frankfurt, Germany',
                isp: 'SecureVPN GmbH',
                timezone: 'Europe/Berlin'
            },
            japan: {
                ip: '103.73.66.' + Math.floor(Math.random() * 255),
                location: 'Tokyo, Japan',
                isp: 'PrivacyShield Co.',
                timezone: 'Asia/Tokyo'
            },
            brazil: {
                ip: '177.54.144.' + Math.floor(Math.random() * 255),
                location: 'S√£o Paulo, Brazil',
                isp: 'AnonBrasil VPN',
                timezone: 'America/Sao_Paulo'
            },
            australia: {
                ip: '103.86.96.' + Math.floor(Math.random() * 255),
                location: 'Sydney, Australia',
                isp: 'DownUnder Privacy',
                timezone: 'Australia/Sydney'
            }
        };

        // Note: Real user data is populated by the earlier ipapi.co fetch

        function toggleVPN() {
            vpnEnabled = !vpnEnabled;
            const toggle = document.getElementById('vpn-toggle');
            const status = document.getElementById('vpn-status');
            const serverSelect = document.getElementById('server-select');
            const protectedPanel = document.getElementById('protected-panel');
            const exposedPanel = document.getElementById('exposed-panel');
            const explanation = document.getElementById('vpn-explanation');

            if (vpnEnabled) {
                toggle.classList.add('active');
                status.textContent = 'VPN ON';
                status.className = 'vpn-status on';
                serverSelect.classList.add('active');
                protectedPanel.classList.add('active-glow');

                // Trigger shake on exposed panel to show danger
                exposedPanel.classList.add('shake');
                setTimeout(() => exposedPanel.classList.remove('shake'), 500);

                // Update VPN data display
                updateVPNDisplay();

                const server = vpnServers[selectedServer];
                explanation.innerHTML = `<strong style="color: #00b894;">Protected!</strong> Websites see <em>${server.location}</em> instead of <em>${realUserData.location}</em>.
                    Your real IP (<em>${realUserData.ip}</em>) is hidden behind the VPN server.`;
            } else {
                toggle.classList.remove('active');
                status.textContent = 'VPN OFF';
                status.className = 'vpn-status off';
                serverSelect.classList.remove('active');
                protectedPanel.classList.remove('active-glow');

                // Clear VPN display
                document.getElementById('vpn-ip').textContent = '---';
                document.getElementById('vpn-location').textContent = '---';
                document.getElementById('vpn-isp').textContent = '---';
                document.getElementById('vpn-timezone').textContent = '---';
                document.getElementById('vpn-visible').textContent = '---';

                explanation.innerHTML = `<strong style="color: #ff4757;">Exposed!</strong> Websites see your real IP (<em>${realUserData.ip}</em>),
                    ISP (<em>${realUserData.isp}</em>), and can pinpoint your location to <em>${realUserData.location}</em>.`;
            }
        }

        function selectServer(btn) {
            // Remove selected from all buttons
            document.querySelectorAll('.server-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');

            selectedServer = btn.dataset.server;

            // Generate new random IP for this server
            vpnServers[selectedServer].ip = vpnServers[selectedServer].ip.split('.').slice(0, 3).join('.') + '.' + Math.floor(Math.random() * 255);

            if (vpnEnabled) {
                updateVPNDisplay();
            }
        }

        function updateVPNDisplay() {
            const server = vpnServers[selectedServer];
            document.getElementById('vpn-ip').textContent = server.ip;
            document.getElementById('vpn-location').textContent = server.location;
            document.getElementById('vpn-isp').textContent = server.isp;
            document.getElementById('vpn-timezone').textContent = server.timezone;
            document.getElementById('vpn-visible').textContent = 'Only VPN provider';
        }

    </script>
</body>
</html>
